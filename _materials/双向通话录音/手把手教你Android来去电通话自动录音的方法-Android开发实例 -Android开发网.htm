<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<head>
        <title>手把手教你Android来去电通话自动录音的方法-Android开发实例 -Android开发网</title>
        <meta name="description" content="我们在使用Android手机打电话时，有时可能会需要对来去电通话自动录音，本文就详细讲解实现Android来去电通话自动录音的方法，大家按照文中的方法编写程序就可以完成此功能。 来去电自动录音的关键在于如何监听手机电话状态的转变： 1）来电的状态的转换如下（红色标记是我们要用到的状态）" />
        <meta name="keywords" content="电话,Service，Android开发，Android开发网" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Content-Language" content="zh-CN" />
	<meta name="generator" content="Z-Blog 1.8 Walle Build 100427" />
	<link rel="stylesheet" href="http://www.jizhuomi.com/android/themes/default/style/jizhuomi/style.css" type="text/css" />
	<link rel="alternate" type="application/rss+xml" href="http://www.jizhuomi.com/android/feed.asp?cmt=354" title="Comments Feed for 手把手教你Android来去电通话自动录音的方法" />
        <link title="RSS 2.0" type="application/rss+xml" href="http://feed.feedsky.com/jizhuomi" rel="alternate" />
	<script src="http://www.jizhuomi.com/android/script/common.js" type="text/javascript"></script>
	<script src="http://www.jizhuomi.com/android/function/c_html_js_add.asp" type="text/javascript"></script>
        <link rel="stylesheet" type="text/css" href="http://www.jizhuomi.com/android/themes/default/style/insertCode.css" />
</head>

<body class="single">
	<div id="header-wrapper">	
		<div id="header">			
		<div id="logo"><img src="http://www.jizhuomi.com/android/themes/default/style/jizhuomi/android-logo.jpg" alt="Android开发网"/></div>	
		<div id="TitleBlock">
                           <h1 id="BlogTitle"><a href="http://www.jizhuomi.com/android/">Android开发网</a></h1>
			<div id="SubTitleLine"><h2 id="BlogSubTitle">Android开发者的加油站  Android学习者的乐园</h2>
			<div id="rss"><a href="http://www.jizhuomi.com/android/rss.xml" target="_blank"><img src="http://www.jizhuomi.com/android/image/logo/xml.gif" height="14" width="36" border="0" alt="订阅本站的 RSS 2.0 新闻聚合" />RSS订阅</a></div></div>
                  </div>	
		</div>
	
	</div><!-- END HEADER-WRAPPER -->
	
	<div id="navigation-wrapper">	
		<div id="navigation">		
			<ul>
<li><a href="http://www.jizhuomi.com/android/">首页</a></li>
<li><a href="http://www.jizhuomi.com/android/environment/">安卓开发环境</a></li>
<li><a href="http://www.jizhuomi.com/android/course/">安卓开发教程</a></li>
<li><a href="http://www.jizhuomi.com/android/video/">安卓开发视频</a></li>
<li><a href="http://www.jizhuomi.com/android/game/">安卓游戏开发</a></li>
<li><a href="http://www.jizhuomi.com/android/example/">安卓开发实例</a></li>
<li><a href="http://www.jizhuomi.com/android/book/">安卓开发书籍</a></li>
<li><a href="http://www.jizhuomi.com/" target="_blank"">鸡啄米博客</a></li>
<li><a href="http://www.jizhuomi.com/android//guestbook.asp">留言簿</a></li>			
			</ul>
		</div>
	
	</div><!-- END NAVIGATION-WRAPPER -->	

<div id="wrapper">													
		<div id="main">		
			<div class="post cate10 auth1">
	<div id="crumbs-wrapper">
			
		<div id="crumbs"><a href="http://www.jizhuomi.com/android/">首页</a> <span class="delimiter">&raquo;</span> <a href="http://www.jizhuomi.com/android/example/">Android开发实例</a> <span class="delimiter">&raquo;</span> <span class="current">手把手教你Android来去电通话自动录音的方法</span></div>			
	</div>
	<div class="title-text">
		<h2>手把手教你Android来去电通话自动录音的方法</h2>
		<h5 class="post-tags">分类标签: <a href="http://www.jizhuomi.com/android/catalog.asp?tags=%E7%94%B5%E8%AF%9D">电话</a>&nbsp;&nbsp;<a href="http://www.jizhuomi.com/android/catalog.asp?tags=Service">Service</a>&nbsp;&nbsp;</h5>
	</div>
	<div class="post-content">	
        <div style="float: left;margin-top:10px;margin-right:10px">
<script type="text/javascript">
var cpro_id="u1975016";
(window["cproStyleApi"] = window["cproStyleApi"] || {})[cpro_id]={at:"3",rsi0:"300",rsi1:"250",pat:"6",tn:"baiduCustNativeAD",rss1:"#FFFFFF",conBW:"1",adp:"1",ptt:"0",titFF:"%E5%BE%AE%E8%BD%AF%E9%9B%85%E9%BB%91",titFS:"14",rss2:"#000000",titSU:"0",ptbg:"70",piw:"0",pih:"0",ptp:"0"}
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
        </div>
        <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 我们在使用Android手机打电话时，有时可能会需要对来去电通话自动录音，本文就详细讲解实现Android来去电通话自动录音的方法，大家按照文中的方法编写程序就可以完成此功能。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>来去电自动录音的关键在于如何监听手机电话状态的转变：</strong></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1）来电的状态的转换如下（红色标记是我们要用到的状态）</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;空闲（IDEL）&mdash;&mdash;&gt; 响铃（RINGING）&mdash;&mdash;&gt; 接听（ACTIVE）&mdash;&mdash;&gt; 挂断（经历DISCONNECTING&mdash;&mdash;DISCONNECTED）&mdash;&mdash;&gt; 空闲（IDEL）&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;或者&nbsp; 空闲（IDEL）&mdash;&mdash;&gt; 响铃（RINGING）&mdash;&mdash;&gt; 拒接 &mdash;&mdash;&gt; 空闲（IDEL）</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2）去电状态的转换如下</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;空闲（IDEL）&mdash;&mdash;&gt; 拨号 （DIALING）&mdash;&mdash;&gt; （对方）响铃（ALERTING） &mdash;&mdash;&gt; 建立连接（ACTIVE）&mdash;&mdash; 挂断（经历DISCONNECTING&mdash;&mdash;DISCONNECTED）&mdash;&mdash;&gt; 空闲（IDEL）&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 或者 空闲（IDEL）&mdash;&mdash;&gt; 拨号 （DIALING）&mdash;&mdash;&gt; （对方）响铃（ALERTING）&mdash;&mdash;&gt; 挂断/对方拒接 &mdash;&mdash;&gt; 空闲（IDEL）</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 下面就分别就来电和去电这两种状态分析并实现。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>1、先进行来电的分析和实现。</strong></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 相对去电来说，来电状态的转换检测要简单些。android api 中的PhoneStateListener 类提供了相应的方法，但我们需要覆盖其中的 onCallStateChanged(int state, String incomingNumber) 方法即可实现来电状态的检测，并在此基础上添加录音功能即可。其中 state 参数就是各种电话状态，到时我们将它跟下面我们要用到的状态进行比较，若是电话处在我们想要的状态上，则进行一系列操作，否则就不管他。想要获取这些状态，还需要另一个电话相关类，那就是 TelephonyManager， 该类 提供了一些电话状态，其中我们要用到的是：TelephonyManager.CALL_STATE_IDLE（空闲）、TelephonyManager.CALL_STATE_OFFHOOK（摘机）和 TelephonyManager.CALL_STATE_RINGING（来电响铃）这三个状态。判别这三种状态，可以继承 android.telephony.PhoneStateListener 类，实现上面提到的 onCallStateChanged(int state, String incomingNumber) 方法，请看如下代码：</p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;TelListener&nbsp;</span><span class="keyword">extends</span><span>&nbsp;PhoneStateListener&nbsp;{&nbsp;&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="annotation">@Override</span><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;onCallStateChanged(</span><span class="keyword">int</span><span>&nbsp;state,&nbsp;String&nbsp;incomingNumber)&nbsp;{&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">super</span><span>.onCallStateChanged(state,&nbsp;incomingNumber);&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">switch</span><span>&nbsp;(state)&nbsp;{&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">case</span><span>&nbsp;TelephonyManager.CALL_STATE_IDLE:&nbsp;</span><span class="comment">//&nbsp;空闲状态，即无来电也无去电&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.i(</span><span class="string">&quot;TelephoneState&quot;</span><span>,&nbsp;</span><span class="string">&quot;IDLE&quot;</span><span>);&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//此处添加一系列功能代码&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">break</span><span>;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">case</span><span>&nbsp;TelephonyManager.CALL_STATE_RINGING:&nbsp;</span><span class="comment">//&nbsp;来电响铃&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.i(</span><span class="string">&quot;TelephoneState&quot;</span><span>,&nbsp;</span><span class="string">&quot;RINGING&quot;</span><span>);&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//此处添加一系列功能代码&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">break</span><span>;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">case</span><span>&nbsp;TelephonyManager.CALL_STATE_OFFHOOK:&nbsp;</span><span class="comment">//&nbsp;摘机，即接通&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.i(</span><span class="string">&quot;TelephoneState&quot;</span><span>,&nbsp;</span><span class="string">&quot;OFFHOOK&quot;</span><span>);&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//此处添加一系列功能代码&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">break</span><span>;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.i(</span><span class="string">&quot;TelephoneState&quot;</span><span>,&nbsp;String.valueOf(incomingNumber));&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 有了以上来电状态监听代码还不足以实现监听功能，还需要在我们的一个<a target="_blank" href="http://www.jizhuomi.com/android/catalog.asp?tags=Activity">Activity</a>或者<a target="_blank" href="http://www.jizhuomi.com/android/catalog.asp?tags=Service">Service</a>中实现监听，方法很简单，代码如下：</p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span class="comment">/**&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">*&nbsp;在activity&nbsp;或者&nbsp;service中加入如下代码，以实现来电状态监听&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>TelephonyManager&nbsp;telMgr&nbsp;=&nbsp;(TelephonyManager)context.getSystemService(&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context.TELEPHONY_SERVICE);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;telMgr.listen(</span><span class="keyword">new</span><span>&nbsp;TelListener(),&nbsp;PhoneStateListener.LISTEN_CALL_STATE);&nbsp;&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这样就实现了来电状态监听功能，但要能够在设备中跑起来，这还不够，它还需要两个获取手机电话状态的权限：</p><div class="codeText"><div class="codeHead">XML/HTML代码</div><ol class="dp-xml">    <li class="alt"><span><span class="tag">&lt;</span><span class="tag-name">uses-permission</span><span>&nbsp;</span><span class="attribute">android:name</span><span>=</span><span class="attribute-value">&quot;android.permission.READ_PHONE_STATE&quot;</span><span>&nbsp;</span><span class="tag">/&gt;</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span class="tag">&lt;</span><span class="tag-name">uses-permission</span><span>&nbsp;</span><span class="attribute">android:name</span><span>=</span><span class="attribute-value">&quot;android.permission.PROCESS_OUTGOING_CALLS&quot;</span><span>&nbsp;</span><span class="tag">/&gt;</span><span>&nbsp;&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这样的话就可以跑起来了。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 说到这，我想如果你可以实现录音功能的话，在此基础上实现来电自动录音就应该没什么问题了，不过请容我简单罗嗦几句。既然是来电，那么要想录音的话，那么应该就是在监听到 TelephonyManager.CALL_STATE_OFFHOOK 的状态时开启录音机开始录音， 在监听到TelephonyManager.CALL_STATE_IDLE 的状态时关闭录音机停止录音。这样，来电录音功能就完成了，不要忘记录音功能同样需要权限：</p><div class="codeText"><div class="codeHead">XML/HTML代码</div><ol class="dp-xml">    <li class="alt"><span><span class="tag">&lt;</span><span class="tag-name">uses-permission</span><span>&nbsp;</span><span class="attribute">android:name</span><span>=</span><span class="attribute-value">&quot;android.permission.RECORD_AUDIO&quot;</span><span class="tag">/&gt;</span><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="comments">&lt;!--&nbsp;要存储文件或者创建文件夹的话还需要以下两个权限&nbsp;--&gt;</span><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="tag">&lt;</span><span class="tag-name">uses-permission</span><span>&nbsp;</span><span class="attribute">android:name</span><span>=</span><span class="attribute-value">&quot;android.permission.MOUNT_UNMOUNT_FILESYSTEMS&quot;</span><span class="tag">/&gt;</span><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="tag">&lt;</span><span class="tag-name">uses-permission</span><span>&nbsp;</span><span class="attribute">android:name</span><span>=</span><span class="attribute-value">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span><span class="tag">/&gt;</span><span>&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>2、介绍完了来电自动录音，下面就来介绍去电自动录音的实现方法。</strong></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 上面说过，相比来电状态的监听，去电的要麻烦些，甚至这种方法不是通用的，这个主要是因为android api 中没有提供去电状态监听的相应类和方法（也许我刚接触，没有找到）。刚开始网上搜索了一通也没有找到对应的解决方法，大多是 来电监听的，也就是上面的方法。不过中途发现一篇博文（后来就搜不到了），记得是查询系统日志的方式，从中找到去电过程中的各个状态的关键词。无奈之中，最终妥协了此方法。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 我的（联想A65上的）去电日志内容如下：</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 过滤关键词为 mforeground</p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.225</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DIALING&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.245</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DIALING&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.631</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DIALING&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.645</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DIALING&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.742</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DIALING&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.766</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DIALING&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.873</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DIALING&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.877</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DIALING&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">55.108</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DIALING&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">55.125</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DIALING&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">57.030</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;ACTIVE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">57.155</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;ACTIVE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">57.480</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;ACTIVE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">57.598</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;ACTIVE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">59.319</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DISCONNECTING&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">59.373</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;DISCONNECTING&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">30</span><span>:</span><span class="number">00.392</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;-&nbsp;onDisconnect:&nbsp;currentlyIdle:</span><span class="keyword">true</span><span>&nbsp;;&nbsp;mForegroundCall.getState():DISCONNECTED&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">30</span><span>:</span><span class="number">00.399</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;-&nbsp;onDisconnect:&nbsp;currentlyIdle:</span><span class="keyword">true</span><span>&nbsp;;&nbsp;mForegroundCall.getState():DISCONNECTED&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">30</span><span>:</span><span class="number">01.042</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">30</span><span>:</span><span class="number">01.070</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">30</span><span>:</span><span class="number">01.558</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">30</span><span>:</span><span class="number">01.572</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp;&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 过滤关键词&nbsp; mbackground</p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.226</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.256</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.638</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.652</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.743</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.770</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.875</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">54.882</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">55.109</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">55.142</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">57.031</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">57.160</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">57.481</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">57.622</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">59.319</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">29</span><span>:</span><span class="number">59.373</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">30</span><span>:</span><span class="number">01.042</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">30</span><span>:</span><span class="number">01.070</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">30</span><span>:</span><span class="number">01.559</span><span>:&nbsp;D/InCallScreen(</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="number">01</span><span>-</span><span class="number">06</span><span>&nbsp;</span><span class="number">16</span><span>:</span><span class="number">30</span><span>:</span><span class="number">01.573</span><span>:&nbsp;V/LogInfo&nbsp;OutGoing&nbsp;Call(</span><span class="number">2492</span><span>):&nbsp;D/InCallScreen(&nbsp;&nbsp;</span><span class="number">251</span><span>):&nbsp;onPhoneStateChanged:&nbsp;mBackgroundCall.getState()&nbsp;:&nbsp;IDLE&nbsp;&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 从上面的日志可以看到，每一行的末尾的大写英文词就是去电的状态，状态说明如下：</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DIALING 拨号，对方还未响铃<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ACTIVE&nbsp;&nbsp; 对方接通，通话建立<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DISCONNECTING 通话断开时<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DISCONNECTED&nbsp; 通话已断开，可以认为是挂机了</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 由于我拨打的是10010，没有响铃过程（电脑自动接通的够快），还少了一个状态，状态是ALERTING&nbsp;，这个就是对方正在响铃的状态。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有了这几个去电状态就好办了，现在我们要做的就是读取系统日志，然后找到这些状态，提取的关键词就是上面提到的 mforeground（前台通话状态） 和 mbackground （后台通话状态）（可能不一样的设备生成的不一样，根据自己具体设备设置，这里只提取前台的），如果读取的这一行日志中 包含 mforground ，再看看是否包含上面的状态的单词。既然说的如此，那么看看读取系统日志的代码吧。</p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span class="keyword">package</span><span>&nbsp;com.sdvdxl.phonerecorder;&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;java.io.BufferedReader;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;java.io.IOException;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;java.io.InputStream;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;java.io.InputStreamReader;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;com.sdvdxl.outgoingcall.OutgoingCallState;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.content.Context;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.content.Intent;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.util.Log;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="comment">/**&nbsp; </span>&nbsp;</li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*&nbsp;@author&nbsp;sdvdxl&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp;找到&nbsp;日志中的&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*&nbsp;&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;这个是前台呼叫状态&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp;mBackgroundCall.getState()&nbsp;后台电话&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*&nbsp;&nbsp;若&nbsp;是&nbsp;DIALING&nbsp;则是正在拨号，等待建立连接，但对方还没有响铃，&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp;ALERTING&nbsp;呼叫成功，即对方正在响铃，&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*&nbsp;&nbsp;若是&nbsp;ACTIVE&nbsp;则已经接通&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp;若是&nbsp;DISCONNECTED&nbsp;则本号码呼叫已经挂断&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*&nbsp;&nbsp;若是&nbsp;IDLE&nbsp;则是处于&nbsp;空闲状态&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp;&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li class="alt"><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;ReadLog&nbsp;</span><span class="keyword">extends</span><span>&nbsp;Thread&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;Context&nbsp;ctx;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;logCount;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;TAG&nbsp;=&nbsp;</span><span class="string">&quot;LogInfo&nbsp;OutGoing&nbsp;Call&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">/**&nbsp; </span>&nbsp;</li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;前后台电话&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@author&nbsp;sdvdxl&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;CallViewState&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;FORE_GROUND_CALL_STATE&nbsp;=&nbsp;</span><span class="string">&quot;mForeground&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">/**&nbsp; </span>&nbsp;</li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;呼叫状态&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@author&nbsp;sdvdxl&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;CallState&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;DIALING&nbsp;=&nbsp;</span><span class="string">&quot;DIALING&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;ALERTING&nbsp;=&nbsp;</span><span class="string">&quot;ALERTING&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;ACTIVE&nbsp;=&nbsp;</span><span class="string">&quot;ACTIVE&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;IDLE&nbsp;=&nbsp;</span><span class="string">&quot;IDLE&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;DISCONNECTED&nbsp;=&nbsp;</span><span class="string">&quot;DISCONNECTED&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;ReadLog(Context&nbsp;ctx)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">this</span><span>.ctx&nbsp;=&nbsp;ctx;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">/**&nbsp; </span>&nbsp;</li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;读取Log流&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;取得呼出状态的log&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;从而得到转换状态&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="annotation">@Override</span><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;run()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;</span><span class="string">&quot;开始读取日志记录&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;catchParams&nbsp;=&nbsp;{</span><span class="string">&quot;logcat&quot;</span><span>,&nbsp;</span><span class="string">&quot;InCallScreen&nbsp;*:s&quot;</span><span>};&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;clearParams&nbsp;=&nbsp;{</span><span class="string">&quot;logcat&quot;</span><span>,&nbsp;</span><span class="string">&quot;-c&quot;</span><span>};&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">try</span><span>&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process&nbsp;process=Runtime.getRuntime().exec(catchParams);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputStream&nbsp;is&nbsp;=&nbsp;process.getInputStream();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedReader&nbsp;reader&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;BufferedReader(</span><span class="keyword">new</span><span>&nbsp;InputStreamReader(is));&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;line&nbsp;=&nbsp;</span><span class="keyword">null</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">while</span><span>&nbsp;((line=reader.readLine())!=</span><span class="keyword">null</span><span>)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logCount++;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//输出所有&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.v(TAG,&nbsp;line);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//日志超过512条就清理&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(logCount&gt;</span><span class="number">512</span><span>)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//清理日志&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Runtime.getRuntime().exec(clearParams)&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.destroy();</span><span class="comment">//销毁进程，释放资源&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logCount&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.v(TAG,&nbsp;</span><span class="string">&quot;-----------清理日志---------------&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">/*---------------------------------前台呼叫-----------------------*/</span><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//空闲&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(line.contains(ReadLog.CallViewState.FORE_GROUND_CALL_STATE)&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;line.contains(ReadLog.CallState.IDLE))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;ReadLog.CallState.IDLE);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//正在拨号，等待建立连接，即已拨号，但对方还没有响铃，&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(line.contains(ReadLog.CallViewState.FORE_GROUND_CALL_STATE)&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;line.contains(ReadLog.CallState.DIALING))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;ReadLog.CallState.DIALING);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//呼叫对方&nbsp;正在响铃&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(line.contains(ReadLog.CallViewState.FORE_GROUND_CALL_STATE)&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;line.contains(ReadLog.CallState.ALERTING))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;ReadLog.CallState.ALERTING);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//已接通，通话建立&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(line.contains(ReadLog.CallViewState.FORE_GROUND_CALL_STATE)&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;line.contains(ReadLog.CallState.ACTIVE))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;ReadLog.CallState.ACTIVE);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//断开连接，即挂机&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(line.contains(ReadLog.CallViewState.FORE_GROUND_CALL_STATE)&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;line.contains(ReadLog.CallState.DISCONNECTED))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;ReadLog.CallState.DISCONNECTED);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="comment">//END&nbsp;while&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="keyword">catch</span><span>&nbsp;(IOException&nbsp;e)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="comment">//END&nbsp;try-catch&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="comment">//END&nbsp;run&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>}&nbsp;</span><span class="comment">//END&nbsp;class&nbsp;ReadLog&nbsp;</span><span>&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 以上代码中，之所以用线程，是为了防止读取日志过程中阻滞主方法的其他方法的执行，影响到程序捕捉对应的电话状态。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 好了，捕捉到了去电过程中各个状态的转变，那么，如何通知给程序呢，我采用的方法是捕获后立马给系统发送广播，然后程序进行广播接收，接收后再处理录音事件。要发送广播，就要发送一个唯一的广播，为此，建立如下类：</p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span class="keyword">package</span><span>&nbsp;com.sdvdxl.outgoingcall;&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;com.sdvdxl.phonerecorder.ReadLog;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.content.Context;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.util.Log;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;OutgoingCallState&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;ctx;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;OutgoingCallState(Context&nbsp;ctx)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">this</span><span>.ctx&nbsp;=&nbsp;ctx;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">/**&nbsp; </span>&nbsp;</li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;前台呼叫状态&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@author&nbsp;sdvdxl&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;ForeGroundCallState&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;DIALING&nbsp;=&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string">&quot;com.sdvdxl.phonerecorder.FORE_GROUND_DIALING&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;ALERTING&nbsp;=&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string">&quot;com.sdvdxl.phonerecorder.FORE_GROUND_ALERTING&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;ACTIVE&nbsp;=&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string">&quot;com.sdvdxl.phonerecorder.FORE_GROUND_ACTIVE&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;IDLE&nbsp;=&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string">&quot;com.sdvdxl.phonerecorder.FORE_GROUND_IDLE&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;DISCONNECTED&nbsp;=&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string">&quot;com.sdvdxl.phonerecorder.FORE_GROUND_DISCONNECTED&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">/**&nbsp; </span>&nbsp;</li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;开始监听呼出状态的转变，&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;并在对应状态发送广播&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;startListen()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">new</span><span>&nbsp;ReadLog(ctx).start();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(</span><span class="string">&quot;Recorder&quot;</span><span>,&nbsp;</span><span class="string">&quot;开始监听呼出状态的转变，并在对应状态发送广播&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>}&nbsp;&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 程序需要读取系统日志权限：</p><div class="codeText"><div class="codeHead">XML/HTML代码</div><ol class="dp-xml">    <li class="alt"><span><span class="tag">&lt;</span><span class="tag-name">uses-permission</span><span>&nbsp;</span><span class="attribute">android:name</span><span>=</span><span class="attribute-value">&quot;android.permission.READ_LOGS&quot;</span><span class="tag">/&gt;</span><span>&nbsp;&nbsp;&nbsp;</span></span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 然后，在读取日志的类中检测到去电各个状态的地方发送一个广播，那么，读取日志的完整代码如下：</p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span class="keyword">package</span><span>&nbsp;com.sdvdxl.phonerecorder;&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;java.io.BufferedReader;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;java.io.IOException;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;java.io.InputStream;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;java.io.InputStreamReader;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;com.sdvdxl.outgoingcall.OutgoingCallState;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.content.Context;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.content.Intent;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.util.Log;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="comment">/**&nbsp; </span>&nbsp;</li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*&nbsp;@author&nbsp;mrloong&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp;找到&nbsp;日志中的&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*&nbsp;&nbsp;onPhoneStateChanged:&nbsp;mForegroundCall.getState()&nbsp;这个是前台呼叫状态&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp;mBackgroundCall.getState()&nbsp;后台电话&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*&nbsp;&nbsp;若&nbsp;是&nbsp;DIALING&nbsp;则是正在拨号，等待建立连接，但对方还没有响铃，&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp;ALERTING&nbsp;呼叫成功，即对方正在响铃，&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*&nbsp;&nbsp;若是&nbsp;ACTIVE&nbsp;则已经接通&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp;若是&nbsp;DISCONNECTED&nbsp;则本号码呼叫已经挂断&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*&nbsp;&nbsp;若是&nbsp;IDLE&nbsp;则是处于&nbsp;空闲状态&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;*&nbsp;&nbsp;&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li class="alt"><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;ReadLog&nbsp;</span><span class="keyword">extends</span><span>&nbsp;Thread&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;Context&nbsp;ctx;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;logCount;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;TAG&nbsp;=&nbsp;</span><span class="string">&quot;LogInfo&nbsp;OutGoing&nbsp;Call&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">/**&nbsp; </span>&nbsp;</li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;前后台电话&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@author&nbsp;sdvdxl&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;CallViewState&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;FORE_GROUND_CALL_STATE&nbsp;=&nbsp;</span><span class="string">&quot;mForeground&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">/**&nbsp; </span>&nbsp;</li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;呼叫状态&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@author&nbsp;sdvdxl&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;CallState&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;DIALING&nbsp;=&nbsp;</span><span class="string">&quot;DIALING&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;ALERTING&nbsp;=&nbsp;</span><span class="string">&quot;ALERTING&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;ACTIVE&nbsp;=&nbsp;</span><span class="string">&quot;ACTIVE&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;IDLE&nbsp;=&nbsp;</span><span class="string">&quot;IDLE&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;DISCONNECTED&nbsp;=&nbsp;</span><span class="string">&quot;DISCONNECTED&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;ReadLog(Context&nbsp;ctx)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">this</span><span>.ctx&nbsp;=&nbsp;ctx;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">/**&nbsp; </span>&nbsp;</li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;读取Log流&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;取得呼出状态的log&nbsp; </span>&nbsp;</span></li>    <li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;从而得到转换状态&nbsp; </span>&nbsp;</span></li>    <li class="alt"><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="annotation">@Override</span><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;run()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;</span><span class="string">&quot;开始读取日志记录&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;catchParams&nbsp;=&nbsp;{</span><span class="string">&quot;logcat&quot;</span><span>,&nbsp;</span><span class="string">&quot;InCallScreen&nbsp;*:s&quot;</span><span>};&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String[]&nbsp;clearParams&nbsp;=&nbsp;{</span><span class="string">&quot;logcat&quot;</span><span>,&nbsp;</span><span class="string">&quot;-c&quot;</span><span>};&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">try</span><span>&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process&nbsp;process=Runtime.getRuntime().exec(catchParams);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputStream&nbsp;is&nbsp;=&nbsp;process.getInputStream();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedReader&nbsp;reader&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;BufferedReader(</span><span class="keyword">new</span><span>&nbsp;InputStreamReader(is));&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;line&nbsp;=&nbsp;</span><span class="keyword">null</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">while</span><span>&nbsp;((line=reader.readLine())!=</span><span class="keyword">null</span><span>)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logCount++;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//输出所有&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.v(TAG,&nbsp;line);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//日志超过512条就清理&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(logCount&gt;</span><span class="number">512</span><span>)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//清理日志&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Runtime.getRuntime().exec(clearParams)&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.destroy();</span><span class="comment">//销毁进程，释放资源&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logCount&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.v(TAG,&nbsp;</span><span class="string">&quot;-----------清理日志---------------&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">/*---------------------------------前台呼叫-----------------------*/</span><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//空闲&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(line.contains(ReadLog.CallViewState.FORE_GROUND_CALL_STATE)&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;line.contains(ReadLog.CallState.IDLE))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;ReadLog.CallState.IDLE);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//正在拨号，等待建立连接，即已拨号，但对方还没有响铃，&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(line.contains(ReadLog.CallViewState.FORE_GROUND_CALL_STATE)&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;line.contains(ReadLog.CallState.DIALING))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//发送广播&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intent&nbsp;dialingIntent&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;Intent();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dialingIntent.setAction(OutgoingCallState.ForeGroundCallState.DIALING);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctx.sendBroadcast(dialingIntent);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;ReadLog.CallState.DIALING);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//呼叫对方&nbsp;正在响铃&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(line.contains(ReadLog.CallViewState.FORE_GROUND_CALL_STATE)&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;line.contains(ReadLog.CallState.ALERTING))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//发送广播&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intent&nbsp;dialingIntent&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;Intent();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dialingIntent.setAction(OutgoingCallState.ForeGroundCallState.ALERTING);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctx.sendBroadcast(dialingIntent);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;ReadLog.CallState.ALERTING);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//已接通，通话建立&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(line.contains(ReadLog.CallViewState.FORE_GROUND_CALL_STATE)&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;line.contains(ReadLog.CallState.ACTIVE))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//发送广播&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intent&nbsp;dialingIntent&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;Intent();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dialingIntent.setAction(OutgoingCallState.ForeGroundCallState.ACTIVE);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctx.sendBroadcast(dialingIntent);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;ReadLog.CallState.ACTIVE);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//断开连接，即挂机&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(line.contains(ReadLog.CallViewState.FORE_GROUND_CALL_STATE)&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;line.contains(ReadLog.CallState.DISCONNECTED))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//发送广播&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intent&nbsp;dialingIntent&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;Intent();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dialingIntent.setAction(OutgoingCallState.ForeGroundCallState.DISCONNECTED);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctx.sendBroadcast(dialingIntent);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;ReadLog.CallState.DISCONNECTED);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="comment">//END&nbsp;while&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="keyword">catch</span><span>&nbsp;(IOException&nbsp;e)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="comment">//END&nbsp;try-catch&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="comment">//END&nbsp;run&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>}&nbsp;</span><span class="comment">//END&nbsp;class&nbsp;ReadLog&nbsp;</span><span>&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 发送了广播，那么就要有接收者，定义接收者如下（关于录音机的代码可以先忽略）：</p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span class="keyword">package</span><span>&nbsp;com.sdvdxl.phonerecorder;&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.content.BroadcastReceiver;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.content.Context;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.content.Intent;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.util.Log;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;com.sdvdxl.outgoingcall.OutgoingCallState;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;OutgoingCallReciver&nbsp;</span><span class="keyword">extends</span><span>&nbsp;BroadcastReceiver&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;TAG&nbsp;=&nbsp;</span><span class="string">&quot;Recorder&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;MyRecorder&nbsp;recorder;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;OutgoingCallReciver()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recorder&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;MyRecorder();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;&nbsp;OutgoingCallReciver&nbsp;(MyRecorder&nbsp;recorder)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">this</span><span>.recorder&nbsp;=&nbsp;recorder;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="annotation">@Override</span><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;onReceive(Context&nbsp;ctx,&nbsp;Intent&nbsp;intent)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;phoneState&nbsp;=&nbsp;intent.getAction();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(phoneState.equals(Intent.ACTION_NEW_OUTGOING_CALL))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;phoneNum&nbsp;=&nbsp;intent.getStringExtra(Intent.EXTRA_PHONE_NUMBER);</span><span class="comment">//拨出号码&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recorder.setPhoneNumber(phoneNum);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recorder.setIsCommingNumber(</span><span class="keyword">false</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;</span><span class="string">&quot;设置为去电状态&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;</span><span class="string">&quot;去电状态&nbsp;呼叫：&quot;</span><span>&nbsp;+&nbsp;phoneNum);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(phoneState.equals(OutgoingCallState.ForeGroundCallState.DIALING))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;</span><span class="string">&quot;正在拨号...&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(phoneState.equals(OutgoingCallState.ForeGroundCallState.ALERTING))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;</span><span class="string">&quot;正在呼叫...&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(phoneState.equals(OutgoingCallState.ForeGroundCallState.ACTIVE))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!recorder.isCommingNumber()&nbsp;&amp;&amp;&nbsp;!recorder.isStarted())&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;</span><span class="string">&quot;去电已接通&nbsp;启动录音机&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recorder.start();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(phoneState.equals(OutgoingCallState.ForeGroundCallState.DISCONNECTED))&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!recorder.isCommingNumber()&nbsp;&amp;&amp;&nbsp;recorder.isStarted())&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;</span><span class="string">&quot;已挂断&nbsp;关闭录音机&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recorder.stop();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span>}&nbsp;&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 其中有这么一段代码：</p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span>String&nbsp;phoneState&nbsp;=&nbsp;intent.getAction();&nbsp;&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(phoneState.equals(Intent.ACTION_NEW_OUTGOING_CALL))&nbsp;{&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;phoneNum&nbsp;=&nbsp;intent.getStringExtra(Intent.EXTRA_PHONE_NUMBER);</span><span class="comment">//拨出号码&nbsp;&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recorder.setPhoneNumber(phoneNum);&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recorder.setIsCommingNumber(</span><span class="keyword">false</span><span>);&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;</span><span class="string">&quot;设置为去电状态&quot;</span><span>);&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG,&nbsp;</span><span class="string">&quot;去电状态&nbsp;呼叫：&quot;</span><span>&nbsp;+&nbsp;phoneNum);&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这里是接收系统发出的广播，用于接收去电广播。这样，就获得了去电状态。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>3、有了以上主要代码，可以说，来去电监听功能算是完成了，下面创建一个service来运行监听：</strong></p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span class="keyword">package</span><span>&nbsp;com.sdvdxl.service;&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.app.Service;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.content.Context;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.content.Intent;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.content.IntentFilter;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.os.IBinder;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.telephony.PhoneStateListener;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.telephony.TelephonyManager;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.util.Log;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.widget.Toast;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;com.sdvdxl.outgoingcall.OutgoingCallState;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;com.sdvdxl.phonerecorder.MyRecorder;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;com.sdvdxl.phonerecorder.OutgoingCallReciver;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;com.sdvdxl.phonerecorder.TelListener;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;PhoneCallStateService&nbsp;</span><span class="keyword">extends</span><span>&nbsp;Service&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;OutgoingCallState&nbsp;outgoingCallState;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;OutgoingCallReciver&nbsp;outgoingCallReciver;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;MyRecorder&nbsp;recorder;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="annotation">@Override</span><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;onCreate()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">super</span><span>.onCreate();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//------以下应放在onStartCommand中，但2.3.5以下版本不会因service重新启动而重新调用--------&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//监听电话状态，如果是打入且接听&nbsp;或者&nbsp;打出&nbsp;则开始自动录音&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//通话结束，保存文件到外部存储器上&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(</span><span class="string">&quot;Recorder&quot;</span><span>,&nbsp;</span><span class="string">&quot;正在监听中...&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recorder&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;MyRecorder();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoingCallState&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;OutgoingCallState(</span><span class="keyword">this</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoingCallReciver&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;OutgoingCallReciver(recorder);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoingCallState.startListen();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Toast.makeText(</span><span class="keyword">this</span><span>,&nbsp;</span><span class="string">&quot;服务已启动&quot;</span><span>,&nbsp;Toast.LENGTH_LONG).show();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//去电&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntentFilter&nbsp;outgoingCallFilter&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;IntentFilter();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoingCallFilter.addAction(OutgoingCallState.ForeGroundCallState.IDLE);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoingCallFilter.addAction(OutgoingCallState.ForeGroundCallState.DIALING);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoingCallFilter.addAction(OutgoingCallState.ForeGroundCallState.ALERTING);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoingCallFilter.addAction(OutgoingCallState.ForeGroundCallState.ACTIVE);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoingCallFilter.addAction(OutgoingCallState.ForeGroundCallState.DISCONNECTED);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoingCallFilter.addAction(</span><span class="string">&quot;android.intent.action.PHONE_STATE&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outgoingCallFilter.addAction(</span><span class="string">&quot;android.intent.action.NEW_OUTGOING_CALL&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//注册接收者&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registerReceiver(outgoingCallReciver,&nbsp;outgoingCallFilter);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//来电&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TelephonyManager&nbsp;telmgr&nbsp;=&nbsp;(TelephonyManager)getSystemService(&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context.TELEPHONY_SERVICE);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;telmgr.listen(</span><span class="keyword">new</span><span>&nbsp;TelListener(recorder),&nbsp;PhoneStateListener.LISTEN_CALL_STATE);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="annotation">@Override</span><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;IBinder&nbsp;onBind(Intent&nbsp;intent)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;TODO&nbsp;Auto-generated&nbsp;method&nbsp;stub&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;</span><span class="keyword">null</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="annotation">@Override</span><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;onDestroy()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">super</span><span>.onDestroy();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unregisterReceiver(outgoingCallReciver);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Toast.makeText(&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">this</span><span>,&nbsp;</span><span class="string">&quot;已关闭电话监听服务&quot;</span><span>,&nbsp;Toast.LENGTH_LONG)&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.show();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(</span><span class="string">&quot;Recorder&quot;</span><span>,&nbsp;</span><span class="string">&quot;已关闭电话监听服务&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="annotation">@Override</span><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;onStartCommand(Intent&nbsp;intent,&nbsp;</span><span class="keyword">int</span><span>&nbsp;flags,&nbsp;</span><span class="keyword">int</span><span>&nbsp;startId)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;START_STICKY;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>}&nbsp;&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 注册以下service：</p><div class="codeText"><div class="codeHead">XML/HTML代码</div><ol class="dp-xml">    <li class="alt"><span><span class="tag">&lt;</span><span class="tag-name">service</span><span>&nbsp;</span><span class="attribute">android:name</span><span>=</span><span class="attribute-value">&quot;com.sdvdxl.service.PhoneCallStateService&quot;</span><span>&nbsp;</span><span class="tag">/&gt;</span><span>&nbsp;&nbsp;</span></span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 到此为止，来去电状态的监听功能算是完成了，剩下一个录音机，附上录音机代码如下：</p><div class="codeText"><div class="codeHead">Java代码</div><ol class="dp-j">    <li class="alt"><span><span class="keyword">package</span><span>&nbsp;com.sdvdxl.phonerecorder;&nbsp; &nbsp;&nbsp;</span></span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;java.io.File;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;java.io.IOException;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;java.text.SimpleDateFormat;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;java.util.Date;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.media.MediaRecorder;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span class="keyword">import</span><span>&nbsp;android.os.Environment;&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">import</span><span>&nbsp;android.util.Log;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp; &nbsp;&nbsp;</span></li>    <li><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;MyRecorder&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;String&nbsp;phoneNumber;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;MediaRecorder&nbsp;mrecorder;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">boolean</span><span>&nbsp;started&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;&nbsp;</span><span class="comment">//录音机是否已经启动&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;</span><span class="keyword">boolean</span><span>&nbsp;isCommingNumber&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;</span><span class="comment">//是否是来电&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">private</span><span>&nbsp;String&nbsp;TAG&nbsp;=&nbsp;</span><span class="string">&quot;Recorder&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;MyRecorder(String&nbsp;phoneNumber)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">this</span><span>.setPhoneNumber(phoneNumber);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;MyRecorder()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;start()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;started&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrecorder&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;MediaRecorder();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;recordPath&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;File(&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Environment.getExternalStorageDirectory()&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;</span><span class="string">&quot;/My&nbsp;record&quot;</span><span>);&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!recordPath.exists())&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recordPath.mkdirs();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(</span><span class="string">&quot;recorder&quot;</span><span>,&nbsp;</span><span class="string">&quot;创建目录&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;callDir&nbsp;=&nbsp;</span><span class="string">&quot;呼出&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(isCommingNumber)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callDir&nbsp;=&nbsp;</span><span class="string">&quot;呼入&quot;</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;fileName&nbsp;=&nbsp;callDir&nbsp;+&nbsp;</span><span class="string">&quot;-&quot;</span><span>&nbsp;+&nbsp;phoneNumber&nbsp;+&nbsp;</span><span class="string">&quot;-&quot;</span><span>&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;</span><span class="keyword">new</span><span>&nbsp;SimpleDateFormat(</span><span class="string">&quot;yy-MM-dd_HH-mm-ss&quot;</span><span>)&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.format(</span><span class="keyword">new</span><span>&nbsp;Date(System.currentTimeMillis()))&nbsp;+&nbsp;</span><span class="string">&quot;.mp3&quot;</span><span>;</span><span class="comment">//实际是3gp&nbsp; </span><span>&nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;recordName&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;File(recordPath,&nbsp;fileName);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">try</span><span>&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recordName.createNewFile();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(</span><span class="string">&quot;recorder&quot;</span><span>,&nbsp;</span><span class="string">&quot;创建文件&quot;</span><span>&nbsp;+&nbsp;recordName.getName());&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="keyword">catch</span><span>&nbsp;(IOException&nbsp;e)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrecorder.setAudioSource(MediaRecorder.AudioSource.DEFAULT);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrecorder.setOutputFormat(MediaRecorder.OutputFormat.DEFAULT);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrecorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT);&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrecorder.setOutputFile(recordName.getAbsolutePath());&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">try</span><span>&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrecorder.prepare();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="keyword">catch</span><span>&nbsp;(IllegalStateException&nbsp;e)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="keyword">catch</span><span>&nbsp;(IOException&nbsp;e)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrecorder.start();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;started&nbsp;=&nbsp;</span><span class="keyword">true</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG&nbsp;,&nbsp;</span><span class="string">&quot;录音开始&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;stop()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">try</span><span>&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">if</span><span>&nbsp;(mrecorder!=</span><span class="keyword">null</span><span>)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrecorder.stop();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrecorder.release();&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrecorder&nbsp;=&nbsp;</span><span class="keyword">null</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;started&nbsp;=&nbsp;</span><span class="keyword">false</span><span>;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span class="keyword">catch</span><span>&nbsp;(IllegalStateException&nbsp;e)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Log.d(TAG&nbsp;,&nbsp;</span><span class="string">&quot;录音结束&quot;</span><span>);&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;pause()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;String&nbsp;getPhoneNumber()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;phoneNumber;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setPhoneNumber(String&nbsp;phoneNumber)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">this</span><span>.phoneNumber&nbsp;=&nbsp;phoneNumber;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">boolean</span><span>&nbsp;isStarted()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;started;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setStarted(</span><span class="keyword">boolean</span><span>&nbsp;hasStarted)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">this</span><span>.started&nbsp;=&nbsp;hasStarted;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">boolean</span><span>&nbsp;isCommingNumber()&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">return</span><span>&nbsp;isCommingNumber;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setIsCommingNumber(</span><span class="keyword">boolean</span><span>&nbsp;isCommingNumber)&nbsp;{&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword">this</span><span>.isCommingNumber&nbsp;=&nbsp;isCommingNumber;&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp;</span></li>    <li><span>&nbsp; &nbsp;&nbsp;</span></li>    <li class="alt"><span>}&nbsp;&nbsp;&nbsp;</span></li></ol></div><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 到此，来去电通话自动录音的所有功能就完成了，大家可以自己试着编写并实现。</p>
<div style="text-align:center;margin:20px 50px 20px 50px;">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-5758371128835119";
/* 小横幅 */
google_ad_slot = "3521468448";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
        <div class="wumii-hook">
        <input type="hidden" name="wurl" value="http://www.jizhuomi.com/android/example/354.html" />
        <input type="hidden" name="wtitle" value="手把手教你Android来去电通话自动录音的方法" />
        
        <script>
             var wumiiSitePrefix = "http://www.jizhuomi.com/android/";
        </script>
        </div>
        <div style="font-size:15px;font-weight:bold;line-height:23px">本文发布：<a href="http://www.jizhuomi.com/android/">Android开发网</a></div>
        <div style="font-size:15px;font-weight:bold;line-height:23px">本文地址：<a href="http://www.jizhuomi.com/android/example/354.html">http://www.jizhuomi.com/android/example/354.html</a></div>
	<div class="post-item-meta">
	<span>2013-1-12 22:18:39</span>
	</div>
	<div class="post-item-meta">
	<span>发布:鸡啄米</span>
	<span>分类:<a href="http://www.jizhuomi.com/android/example/">Android开发实例</a></span>
	<span>浏览:<span id="spn354"></span></span>
<script language="JavaScript" type="text/javascript">strBatchCount+="spn354=354,"</script>
	<span class="comments"><a href="http://www.jizhuomi.com/android/example/354.html#comment">评论:0</a></span>
	</div>
	</div>
</div>
<br />

<div class="post-nav">上一篇：<a href="http://www.jizhuomi.com/android/game/353.html">教你如何选择Android游戏引擎</a></div>
<div class="post-nav">下一篇：<a href="http://www.jizhuomi.com/android/book/355.html">《Android 2高级编程（第2版）》</a></div>

<!--<ul class="msg trackback">
	<li class="tbname"><a href="http://www.jizhuomi.com/android/cmd.asp?act=gettburl&amp;id=354" target="_blank">点击这里获取该日志的TrackBack引用地址</a></li>
</ul>-->
<ul class="msg mutuality">
	<li class="tbname">相关文章:</li>
	<li class="msgarticle"><p><a  href="http://www.jizhuomi.com/android/example/348.html">Android电话拦截及拦截提示音的实现</a>&nbsp;&nbsp;(2013-1-7 22:36:33)</p><p><a  href="http://www.jizhuomi.com/android/example/309.html">Android手机接通电话后振动提示的实例</a>&nbsp;&nbsp;(2012-12-10 21:11:34)</p><p><a  href="http://www.jizhuomi.com/android/video/216.html">Android开发视频教程之三十四（代码编写 六）</a>&nbsp;&nbsp;(2012-9-24 22:3:38)</p><p><a  href="http://www.jizhuomi.com/android/video/211.html">Android开发视频教程之三十三（代码编写 五）</a>&nbsp;&nbsp;(2012-9-21 0:27:34)</p><p><a  href="http://www.jizhuomi.com/android/video/193.html">Android开发视频教程之三十（代码编写 二）</a>&nbsp;&nbsp;(2012-9-8 23:21:21)</p><p><a  href="http://www.jizhuomi.com/android/video/181.html">Android开发视频教程之二十八（项目详细设计）</a>&nbsp;&nbsp;(2012-8-30 21:46:3)</p><p><a  href="http://www.jizhuomi.com/android/video/169.html">Android开发视频教程之二十五（Service初步 一）</a>&nbsp;&nbsp;(2012-8-22 0:6:15)</p><p><a  href="http://www.jizhuomi.com/android/course/162.html">Android学习指南之二十二：实例讲解AIDL和远程Service调用</a>&nbsp;&nbsp;(2012-8-16 22:15:57)</p><p><a  href="http://www.jizhuomi.com/android/example/116.html">Android手机拨打电话的开发实例</a>&nbsp;&nbsp;(2012-7-16 23:20:10)</p><p><a  href="http://www.jizhuomi.com/android/course/113.html">Android学习指南之十四：Service详解及应用实例</a>&nbsp;&nbsp;(2012-7-14 6:36:19)</p></li>
</ul>

<div style="display:none;" id="divAjaxComment"></div>

<div class="post-comment" id="divCommentPost">
	<p class="posttop"><a name="comment">发表评论:</a></p>
	<form id="frmSumbit" target="_self" method="post" action="http://www.jizhuomi.com/android/cmd.asp?act=cmt&amp;key=b32f3c08" >
	<input type="hidden" name="inpId" id="inpId" value="354" />
	<input type="hidden" name="inpArticle" id="inpArticle" value="" />
	<input type="hidden" name="inpLocation" id="inpLocation" value="" />
	<p><input type="text" name="inpName" id="inpName" class="text" value="" size="28" tabindex="1" /> <label for="inpName">名称(*)</label></p>
	<p><input type="text" name="inpEmail" id="inpEmail" class="text" value="" size="28" tabindex="2" /> <label for="inpEmail">邮箱(选填)</label></p>
	<p><input type="text" name="inpHomePage" id="inpHomePage" class="text" value="" size="28" tabindex="3" /> <label for="inpHomePage">网站链接(选填)</label></p>
		<p><input type="text" name="inpVerify" id="inpVerify" class="text" value="" size="28" tabindex="4" /> <label for="inpVerify">验证(*)</label> <img style="border:1px solid black" src="http://www.jizhuomi.com/android/function/c_validcode.asp?name=commentvalid" alt="" title=""/></p>
	<p><label for="txaArticle">正文(*)(留言最长字数:1000)</label></p>
	<p><textarea name="txaArticle" id="txaArticle" onchange="GetActiveText(this.id);" onclick="GetActiveText(this.id);" onfocus="GetActiveText(this.id);" class="text" cols="50" rows="4" tabindex="5" ></textarea></p>
	<p><input name="btnSumbit" type="submit" tabindex="6" value="提交" onclick="JavaScript:return VerifyMessage()" class="button" /> <input type="checkbox" name="chkRemember" value="1" id="chkRemember" /> <label for="chkRemember">记住我,下次回复时不用重新输入个人信息</label></p>
	<script language="JavaScript" type="text/javascript">objActive="txaArticle";ExportUbbFrame();</script>
	</form>
	<p class="postbottom">◎欢迎参与讨论，请在这里发表您的看法、交流您的观点。</p>
	<script language="JavaScript" type="text/javascript">LoadRememberInfo();</script>
</div>

<script type="text/javascript">document.body.oncopy=function(){if (navigator.userAgent.indexOf("MSIE") != -1) {event.returnValue=false;var t=document.selection.createRange().text;var s="本文来源于Android开发网 http://www.jizhuomi.com/android/ , 原文地址：http://www.jizhuomi.com/android/example/354.html ";clipboardData.setData('Text','\r\n'+t+'\r\n'+s+'\r\n\r\n');}}</script>							
		</div><!-- END MAIN -->	
							
	<div id="sidebar">	
		<div class="widget">
<h3>订阅Android开发网</h3>
<ul>
<a href="http://mail.qq.com/cgi-bin/feed?u=http://feed.feedsky.com/AndroidDevelop" target="_blank" rel="nofollow"><img border="0" src="http://img.feedsky.com/images/icon_subshot02_qq.gif" alt="订阅到QQ邮箱" vspace="2" style="margin-bottom:3px" ></a>
<a href="http://reader.youdao.com/b.do?keyfrom=feedsky&url=http://feed.feedsky.com/AndroidDevelop" target="_blank" rel="nofollow"><img border="0" src="http://img.feedsky.com/images/icon_subshot02_youdao.gif" alt="订阅到有道 RSS阅读器" vspace="2" style="margin-bottom:3px" ></a>
</ul>			
		</div>	

<div style="text-align:center;margin:10px 1px 10px 5px;float:left;">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-5758371128835119";
/* 300&#42;250中矩形 */
google_ad_slot = "5560387389";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>	

<div style="text-align:center;margin:10px 1px 10px 5px;float:left;">
<script type="text/javascript">
    /*侧栏300*250，创建于2012-4-19*/
    var cpro_id = "u857987";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
</div>

			<div class="widget" id="divSearchPanel">
<h3>站内搜索</h3>
<ul>
<li>
			<form method="post" id="searchform" action="http://www.jizhuomi.com/android/cmd.asp?act=Search">
	<input type="text" name="edtSearch" id="s" value="请输入搜索内容.." onfocus='if (this.value == "请输入搜索内容..") { this.value = ""; }' onblur='if (this.value == "") { this.value = "请输入搜索内容.."; }' />
	<input type="image" src="http://www.jizhuomi.com/android/themes/default/style/jizhuomi/search-button.png" value="" name="btnPost" id="search-button" />
			</form>	
</li>
</ul>		
			</div>

<div class="widget">
<h3>分类标签</h3>
<ul>
<li id="mod_bftags" style="display:none;"><script type="text/javascript">strBatchInculde+="mod_bftags=bftags,"</script></li>
<li><a href="http://www.jizhuomi.com/android/tags.asp" target="_blank">更多标签</a></li>
</ul>
</div>

<div class="widget">
<h3>完全随机文章</h3>
<ul>
<li id="mod_randomsortallrand" style="display:none;"><script type="text/javascript">strBatchInculde+="mod_randomsortallrand=randomsortallrand,"</script></li>
</ul>
</div>

<div class="widget" id="divComments">
<h3>最新评论及回复</h3>
<ul id="ulComments">
<li id="mod_comments" style="display:none;"><script type="text/javascript">strBatchInculde+="mod_comments=comments,"</script></li>
</ul>
</div>

<div class="widget" id="divPrevious">
<h3>最近发表</h3>
<ul id="ulPrevious">
<li id="mod_previous" style="display:none;"><script type="text/javascript">strBatchInculde+="mod_previous=previous,"</script></li>
</ul>
</div>

<div id="box">
<div id="float" class="div1"> 
<script type="text/javascript">
    /*侧栏跟随300*250 创建于 2014-10-09*/
    var cpro_id = "u1749555";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
</div>
</div>

		</div><!-- END SIDEBAR -->		
	
	</div><!-- END WRAPPER -->
		
	<div id="footer-bottom-wrapper">	
		<div id="footer-bottom">		
			<span class="footer-left">Copyright © 2011-2013 Android开发网. 版权所有.</span>
			<span class="footer-right">联系邮箱:jizhuomi@126.com &nbsp;&nbsp;Powered By Z-Blog &nbsp;&nbsp;<script src="http://s13.cnzz.com/stat.php?id=3740214&web_id=3740214&show=pic" language="JavaScript"></script></span>		
		</div>	
	</div>

<!-- Baidu Button BEGIN -->
    <script type="text/javascript" id="bdshare_js" data="type=slide&amp;img=0&amp;uid=15514" ></script>
    <script type="text/javascript" id="bdshell_js"></script>
    <script type="text/javascript">
        document.getElementById("bdshell_js").src = "http://share.baidu.com/static/js/shell_v2.js?t=" + new Date().getHours();
    </script>
<!-- Baidu Button END -->

<script type="text/javascript">
    var wumiiParams = "&num=5&mode=2&pf=Z-Blog";
</script>
<script type="text/javascript" id="wumiiRelatedItems" src="http://widget.wumii.com/ext/relatedItemsWidget.htm"></script>
<a href="http://www.wumii.com/widget/relatedItems.htm" style="border:0;">
    <img src="http://static.wumii.com/images/pixel.png" alt="无觅相关文章插件" style="border:0;padding:0;margin:0;" />
</a>

<script type="text/javascript">
    /* 图+ 创建于 2014-09-02*/
var cpro_id = "u1694871";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/i.js" type="text/javascript"></script>

<script type="text/javascript">
    /* 站搜（创建于 2014-11-28）*/
var cpro_id = "u1834317";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/cnw.js" type="text/javascript"></script>

</body>
</html>
<!-- 2015-3-6 20:34:45 -->